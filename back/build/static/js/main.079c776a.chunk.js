(this.webpackJsonpbike_checker=this.webpackJsonpbike_checker||[]).push([[0],{17:function(e,t,n){e.exports=n(45)},22:function(e,t,n){},23:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(15),l=n.n(c),u=(n(22),n(3)),s=(n(23),n(2)),o=n.n(s),i=n(4),m={BIKE_API_URI:"./api",LOGIN_API_URI:"https://safe-retreat-57854.herokuapp.com"},E=n(5),b=n.n(E),f="".concat(m.BIKE_API_URI,"/bikeData"),d=0,p={getBikeData:function(){var e=Object(i.a)(o.a.mark((function e(){var t,n,a,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(new Date).valueOf(),6e4,!(d>t-6e4)){e.next=4;break}return e.abrupt("return",null);case 4:return e.next=6,b.a.get(f);case 6:if(200===(n=e.sent).status&&n.data&&n.data.bikeData){e.next=10;break}return console.log("BIKEDATA: FETCH FAILED",n.status),e.abrupt("return",null);case 10:return a=n.data.bikeData,r=a.lastFetchTime,c=a.stations,d=r,e.abrupt("return",{lastFetchTime:r,stations:c});case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},I=n(16),v=(n(42),function(e){var t=e.station,n=e.selectCenter,a=e.isCenter,c=t.name,l=t.bikesAvailable,u=l+t.spacesAvailable,s="".concat(l," / ").concat(u),o=a?"station-list-item center":"station-list-item",i="bad";return l>3?i="good":l>0&&(i="neutral"),r.a.createElement("tr",{className:o,onDoubleClick:function(){return n(t)}},r.a.createElement("td",null,c),r.a.createElement("td",null,s),r.a.createElement("td",null,r.a.createElement("div",{className:"status-marker ".concat(i)})))}),O=function(e){var t=e.centerId,n=e.setCenter,c=e.stations,l=e.lastFetchTime,s=Object(a.useState)(""),o=Object(u.a)(s,2),i=o[0],m=o[1];if(0===c.length)return r.a.createElement("div",null,r.a.createElement("br",null),"FETCHING DATA - WAIT A MOMENT");var E=function(e){var t=Object(I.a)({lastFetchTime:l},e);window.localStorage.setItem("centerStation",JSON.stringify(t)),n(t)},b=i.toLowerCase(),f=c.filter((function(e){return e.name.toLowerCase().includes(b)})).map((function(e){return r.a.createElement(v,{key:e.stationId,station:e,selectCenter:E,isCenter:e.stationId===t})}));return r.a.createElement("div",null,r.a.createElement("br",null),"FILTER STATIONS: ",r.a.createElement("input",{onChange:function(e){return m(e.target.value)},list:"nameData",value:i,type:"search"}),r.a.createElement("br",null),"Double Click to select",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("table",{id:"station-list-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"NAME"),r.a.createElement("th",null,"BIKES/SPACE"))),r.a.createElement("tbody",null,f)),r.a.createElement("datalist",{id:"nameData"},c.map((function(e){return r.a.createElement("option",{key:e.stationId,value:e.name})}))))},S=(n(43),function(){var e=Object(i.a)(o.a.mark((function e(t){var n,a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.getBikeData();case 2:if((n=e.sent)&&0!==n.lastFetchTime&&0!==n.stations.length){e.next=5;break}return e.abrupt("return");case 5:a=n.lastFetchTime,r=n.stations,t({lastFetchTime:a,stations:r});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h=function(e){var t=e.center,n=t.name,a=t.bikesAvailable,c=a+t.spacesAvailable,l="".concat(a," / ").concat(c),u="bad";return a>3?u="good":a>0&&(u="neutral"),r.a.createElement("table",{id:"center-table",className:u},r.a.createElement("thead",null,r.a.createElement("tr",{key:1},r.a.createElement("th",null,"NAME"),r.a.createElement("th",null,"BIKES/SPACE"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,n),r.a.createElement("td",null,l))))},k=function(){var e=Object(a.useState)({lastFetchTime:0,stations:[]}),t=Object(u.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)((function(){return function(){var e={name:"NO CENTER SELECTED",bikesAvailable:0,spacesAvailable:0,stationId:null};try{var t=window.localStorage.getItem("centerStation");return t?JSON.parse(t):e}catch(n){return e}}()})),s=Object(u.a)(l,2),o=s[0],i=s[1],m=Object(a.useState)(!o.stationId),E=Object(u.a)(m,2),b=E[0],f=E[1],d=n.lastFetchTime,p=n.stations;Object(a.useEffect)((function(){S(c);var e=setInterval((function(){S(c)}),1e4);return function(){clearTimeout(e)}}),[]);var I=p.find((function(e){return e.stationId===o.stationId}))||o,v=new Date(d||o.lastFetchTime).toLocaleString(),k=b?"HIDE LIST":"CHANGE STATION";return r.a.createElement("div",{id:"station-screen"},r.a.createElement("div",{id:"center-screen"},r.a.createElement("h2",null,"YOUR STATION"),r.a.createElement(h,{center:I}),r.a.createElement("br",null),v),r.a.createElement("br",null),r.a.createElement("button",{onClick:function(){return f((function(e){return!e}))}},k),r.a.createElement("br",null),b&&r.a.createElement(O,{centerId:o.stationId,setCenter:i,stations:p,lastFetchTime:d}))},A="".concat(m.LOGIN_API_URI,"/api/users"),T={login:function(){var e=Object(i.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post(A,{username:t,password:n});case 3:if(201===(a=e.sent).status&&a.data){e.next=7;break}return console.log("LOGIN: FAILED",a.status),e.abrupt("return",!1);case 7:return console.log("LOGIN DONE"),a.data.token||"",""!==a.data.token&&window.localStorage.setItem("userToken",a.data.token),e.abrupt("return",!0);case 13:return e.prev=13,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}()},g=(n(44),function(e){var t=e.setUser,n=Object(a.useState)(""),c=Object(u.a)(n,2),l=c[0],s=c[1],m=Object(a.useState)(""),E=Object(u.a)(m,2),b=E[0],f=E[1],d=Object(a.useState)(""),p=Object(u.a)(d,2),I=p[0],v=p[1],O=function(){var e=Object(i.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),""!==l&&""!==b){e.next=6;break}return console.log("MISSIN USERNAME OR PASSWORD"),v("MISSIN USERNAME OR PASSWORD"),setTimeout((function(){v("")}),5e3),e.abrupt("return");case 6:return e.next=8,T.login(l,b);case 8:e.sent?(window.localStorage.setItem("storedUser",l),t(l)):(console.log("LOGIN FAILED"),v("INVALID USER INFORMATION"),setTimeout((function(){v("")}),5e3));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{id:"login-screen"},r.a.createElement("form",{onSubmit:O},"USERNAME: ",r.a.createElement("input",{onChange:function(e){return s(e.target.value)},value:l,name:"username"}),r.a.createElement("br",null),"PASSWORD: ",r.a.createElement("input",{type:"password",onChange:function(e){return f(e.target.value)},name:"password",value:b}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("button",{type:"submit"},"LOGIN"),r.a.createElement("br",null),r.a.createElement("br",null),I,r.a.createElement("br",null)))}),N=function(){var e=Object(a.useState)(function(){try{return window.localStorage.getItem("storedUser")}catch(e){return null}}()),t=Object(u.a)(e,2),n=t[0],c=t[1],l=n?"USER: ".concat(n):"Login or Create New User";return r.a.createElement("div",{className:"App"},r.a.createElement("h1",null,"HSL CITYBIKE CHECKER"),r.a.createElement("h3",null,l),n?r.a.createElement(k,null):r.a.createElement(g,{setUser:c}),r.a.createElement("br",null),n&&r.a.createElement("button",{onClick:function(){window.localStorage.clear(),c(null)}},"LOGOUT"))};l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(N,null)),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.079c776a.chunk.js.map